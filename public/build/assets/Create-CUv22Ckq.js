import{d as U,c as m,b as s,u as i,h as z,e as o,f as t,p as V,i as r,o as u,F as v,j as y,t as $,g as q,l as D,T as E,q as F,v as T,r as G,m as O}from"./app-zceEsHJ0.js";import{R as I}from"./RoleController-DyEMbwZF.js";import{_ as L}from"./Heading.vue_vue_type_script_setup_true_lang-Cam_v4pF.js";import{_ as h}from"./InputError.vue_vue_type_script_setup_true_lang-B8Db0rPd.js";import{d as H,_ as p}from"./index-DB_XGDUr.js";import{_ as J,a as K}from"./CardContent.vue_vue_type_script_setup_true_lang-BXq8GHXQ.js";import{_ as M}from"./CardHeader.vue_vue_type_script_setup_true_lang-Dq9JKDvM.js";import{_ as R}from"./Input.vue_vue_type_script_setup_true_lang-pJXYoyuZ.js";import{_ as b}from"./Label.vue_vue_type_script_setup_true_lang-CnMsaaRU.js";import{_ as Q}from"./Separator.vue_vue_type_script_setup_true_lang-DhkxCYCw.js";import{q as B,r as W,_ as X}from"./AppLayout.vue_vue_type_script_setup_true_lang-DQL6Uiit.js";import{S as Y}from"./users-CJ-0RK9x.js";import"./index-BNxF7y-0.js";import"./useForwardExpose-69XdW_7x.js";import"./TooltipTrigger.vue_vue_type_script_setup_true_lang-DSTKZO8D.js";import"./createLucideIcon-BcTsVLkY.js";import"./useForwardPropsEmits-BurJBUp9.js";import"./PopperContent-g9pRJxp3.js";import"./Collection-B-As6IPU.js";import"./Teleport--CePYlX6.js";import"./VisuallyHidden-CyNFWOY2.js";import"./index-CYocFbH6.js";import"./useTypeahead-BW9vDtnA.js";import"./RovingFocusGroup-mtgOdsSh.js";import"./utils-DFOM33Ye.js";import"./chevrons-up-down-B51xlHsI.js";import"./SheetDescription.vue_vue_type_script_setup_true_lang-5P20ap5Q.js";import"./user-CzYV7n64.js";import"./thumbs-up-DG75xrWo.js";const Z={class:"w-full space-y-6 rounded-xl p-4"},ee={class:"flex items-center gap-3"},se={class:"flex h-12 w-12 items-center justify-center rounded-xl bg-primary/10"},te={class:"grid grid-cols-1 gap-6 lg:grid-cols-2"},ie={class:"grid gap-2"},oe={class:"grid gap-2"},ae={class:"space-y-4"},ne={class:"flex flex-wrap items-center gap-4"},le={class:"flex gap-2"},re=["value"],de={class:"flex flex-wrap items-center justify-between gap-2"},me={class:"font-medium"},ue={class:"flex gap-1"},ce={class:"flex flex-wrap gap-x-6 gap-y-2"},fe=["id","checked","onChange"],pe={key:0,class:"text-sm text-muted-foreground"},_e={class:"flex flex-wrap items-center gap-3 pt-2"},ge={class:"inline-flex items-center gap-1.5 rounded-md bg-green-500/10 px-2.5 py-1 text-sm font-medium text-green-700 dark:text-green-400"},Je=U({__name:"Create",props:{permissionsByResource:{}},setup(x){const k=x,n=G([]),A=O(()=>{const a=[];for(const e of Object.values(k.permissionsByResource))for(const l of e)a.push(l.id);return a});function S(a){return(k.permissionsByResource[a]??[]).map(e=>e.id)}function w(a){n.value=a?[...A.value]:[]}function C(a,e){const l=S(a);if(e){const c=new Set(n.value);l.forEach(_=>c.add(_)),n.value=Array.from(c)}else{const c=new Set(l);n.value=n.value.filter(_=>!c.has(_))}}function N(a,e){e?n.value.includes(a)||(n.value=[...n.value,a]):n.value=n.value.filter(l=>l!==a)}const P=[{title:"Dashboard",href:H().url},{title:"Roles",href:B().url},{title:"Create",href:W().url}];return(a,e)=>(u(),m(v,null,[s(i(z),{title:"Create Role"}),s(X,{breadcrumbs:P},{default:o(()=>[t("div",Z,[t("div",ee,[t("div",se,[s(i(Y),{class:"h-6 w-6 text-primary"})]),t("div",null,[s(L,{title:"Create Role",description:"Add a new role (e.g. Admin, Editor)"})])]),t("div",te,[s(i(J),{class:"lg:col-span-2"},{default:o(()=>[s(i(V),{action:i(I).store()},{default:o(({errors:l,processing:c,recentlySuccessful:_})=>[s(i(M),{class:"pb-4"},{default:o(()=>[...e[2]||(e[2]=[t("h3",{class:"text-sm font-medium text-muted-foreground"}," Role details ",-1)])]),_:1}),s(i(K),{class:"space-y-6"},{default:o(()=>[t("div",ie,[s(i(b),{for:"name"},{default:o(()=>[...e[3]||(e[3]=[r("Name ",-1),t("span",{class:"text-destructive"},"*",-1)])]),_:1}),s(i(R),{id:"name",name:"name",required:"",placeholder:"e.g. admin, editor",class:"transition-colors focus-visible:ring-2"}),e[4]||(e[4]=t("p",{class:"text-xs text-muted-foreground"}," Use lowercase, no spaces (e.g. admin, content-editor) ",-1)),s(h,{message:l.name},null,8,["message"])]),t("div",oe,[s(i(b),{for:"guard_name"},{default:o(()=>[...e[5]||(e[5]=[r("Guard name",-1)])]),_:1}),s(i(R),{id:"guard_name",name:"guard_name",placeholder:"web (default)",class:"font-mono transition-colors focus-visible:ring-2"}),e[6]||(e[6]=t("p",{class:"text-xs text-muted-foreground"},' Usually "web" for web applications ',-1)),s(h,{message:l.guard_name},null,8,["message"])]),s(i(Q)),t("div",ae,[t("div",ne,[e[9]||(e[9]=t("h3",{class:"text-sm font-medium text-muted-foreground"}," Permissions (from policies) ",-1)),t("div",le,[s(i(p),{type:"button",variant:"outline",size:"sm",onClick:e[0]||(e[0]=f=>w(!0))},{default:o(()=>[...e[7]||(e[7]=[r(" Check all ",-1)])]),_:1}),s(i(p),{type:"button",variant:"outline",size:"sm",onClick:e[1]||(e[1]=f=>w(!1))},{default:o(()=>[...e[8]||(e[8]=[r(" Uncheck all ",-1)])]),_:1})])]),e[12]||(e[12]=t("p",{class:"text-xs text-muted-foreground"}," Assign policy-based permissions to this role. Users with this role will be able to perform the selected actions. ",-1)),(u(!0),m(v,null,y(n.value,f=>(u(),m("input",{key:`hidden-${f}`,type:"hidden",name:"permission_ids[]",value:f},null,8,re))),128)),(u(!0),m(v,null,y(x.permissionsByResource,(f,g)=>(u(),m("div",{key:g,class:"space-y-2 rounded-lg border p-4"},[t("div",de,[t("h4",me,$(g),1),t("div",ue,[s(i(p),{type:"button",variant:"ghost",size:"sm",class:"h-7 text-xs",onClick:d=>C(g,!0)},{default:o(()=>[...e[10]||(e[10]=[r(" Check all ",-1)])]),_:1},8,["onClick"]),s(i(p),{type:"button",variant:"ghost",size:"sm",class:"h-7 text-xs",onClick:d=>C(g,!1)},{default:o(()=>[...e[11]||(e[11]=[r(" Uncheck all ",-1)])]),_:1},8,["onClick"])])]),t("div",ce,[(u(!0),m(v,null,y(f,d=>(u(),m("div",{key:d.id,class:"flex items-center space-x-2"},[t("input",{id:`perm-${d.id}`,type:"checkbox",checked:n.value.includes(d.id),class:"h-4 w-4 rounded border-input accent-primary",onChange:j=>N(d.id,j.target.checked)},null,40,fe),s(i(b),{for:`perm-${d.id}`,class:"text-sm font-normal cursor-pointer"},{default:o(()=>[r($(d.ability_label),1)]),_:2},1032,["for"])]))),128))])]))),128)),Object.keys(x.permissionsByResource).length===0?(u(),m("p",pe," No policy permissions found. Add can('Ability:Resource') in app/Policies to discover them. ")):q("",!0),s(h,{message:l.permission_ids},null,8,["message"])]),t("div",_e,[s(i(p),{disabled:c,type:"submit"},{default:o(()=>[...e[13]||(e[13]=[r(" Create Role ",-1)])]),_:1},8,["disabled"]),s(i(p),{variant:"outline","as-child":""},{default:o(()=>[s(i(D),{href:i(B)().url},{default:o(()=>[...e[14]||(e[14]=[r("Cancel",-1)])]),_:1},8,["href"])]),_:1}),s(E,{"enter-active-class":"transition ease-out duration-200","enter-from-class":"opacity-0 translate-y-1","leave-active-class":"transition ease-in duration-150","leave-to-class":"opacity-0"},{default:o(()=>[F(t("span",ge,[...e[15]||(e[15]=[t("span",{class:"h-1.5 w-1.5 rounded-full bg-green-500"},null,-1),r(" Role created successfully ",-1)])],512),[[T,_]])]),_:2},1024)])]),_:2},1024)]),_:1},8,["action"])]),_:1})])])]),_:1})],64))}});export{Je as default};
