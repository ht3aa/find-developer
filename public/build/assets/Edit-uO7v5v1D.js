import{d as E,r as z,c as m,b as s,u as i,h as T,e as a,f as t,p as V,i as r,o as f,F as h,j as y,t as C,g as q,l as A,T as D,q as F,v as G,m as O}from"./app-zceEsHJ0.js";import{R as I}from"./RoleController-DyEMbwZF.js";import{_ as L}from"./Heading.vue_vue_type_script_setup_true_lang-Cam_v4pF.js";import{_ as b}from"./InputError.vue_vue_type_script_setup_true_lang-B8Db0rPd.js";import{d as H,_ as g}from"./index-DB_XGDUr.js";import{_ as J,a as K}from"./CardContent.vue_vue_type_script_setup_true_lang-BXq8GHXQ.js";import{_ as M}from"./CardHeader.vue_vue_type_script_setup_true_lang-Dq9JKDvM.js";import{_ as R}from"./Input.vue_vue_type_script_setup_true_lang-pJXYoyuZ.js";import{_ as k}from"./Label.vue_vue_type_script_setup_true_lang-CnMsaaRU.js";import{_ as Q}from"./Separator.vue_vue_type_script_setup_true_lang-DhkxCYCw.js";import{q as B,t as W,_ as X}from"./AppLayout.vue_vue_type_script_setup_true_lang-DQL6Uiit.js";import{S as Y}from"./users-CJ-0RK9x.js";import"./index-BNxF7y-0.js";import"./useForwardExpose-69XdW_7x.js";import"./TooltipTrigger.vue_vue_type_script_setup_true_lang-DSTKZO8D.js";import"./createLucideIcon-BcTsVLkY.js";import"./useForwardPropsEmits-BurJBUp9.js";import"./PopperContent-g9pRJxp3.js";import"./Collection-B-As6IPU.js";import"./Teleport--CePYlX6.js";import"./VisuallyHidden-CyNFWOY2.js";import"./index-CYocFbH6.js";import"./useTypeahead-BW9vDtnA.js";import"./RovingFocusGroup-mtgOdsSh.js";import"./utils-DFOM33Ye.js";import"./chevrons-up-down-B51xlHsI.js";import"./SheetDescription.vue_vue_type_script_setup_true_lang-5P20ap5Q.js";import"./user-CzYV7n64.js";import"./thumbs-up-DG75xrWo.js";const Z={class:"w-full space-y-6 rounded-xl p-4"},ee={class:"flex items-center gap-3"},se={class:"flex h-12 w-12 items-center justify-center rounded-xl bg-primary/10"},te={class:"grid grid-cols-1 gap-6 lg:grid-cols-2"},ie={class:"grid gap-2"},ae={class:"grid gap-2"},le={class:"space-y-4"},oe={class:"flex flex-wrap items-center gap-4"},ne={class:"flex gap-2"},re=["value"],de={class:"flex flex-wrap items-center justify-between gap-2"},ue={class:"font-medium"},me={class:"flex gap-1"},fe={class:"flex flex-wrap gap-x-6 gap-y-2"},ce=["id","checked","onChange"],pe={key:0,class:"text-sm text-muted-foreground"},ge={class:"flex flex-wrap items-center gap-3 pt-2"},ve={class:"inline-flex items-center gap-1.5 rounded-md bg-green-500/10 px-2.5 py-1 text-sm font-medium text-green-700 dark:text-green-400"},Je=E({__name:"Edit",props:{role:{},permissionsByResource:{}},setup(d){const v=d,o=z([...v.role.permission_ids??[]]),S=O(()=>{const l=[];for(const e of Object.values(v.permissionsByResource))for(const n of e)l.push(n.id);return l});function N(l){return(v.permissionsByResource[l]??[]).map(e=>e.id)}function $(l){o.value=l?[...S.value]:[]}function w(l,e){const n=N(l);if(e){const c=new Set(o.value);n.forEach(_=>c.add(_)),o.value=Array.from(c)}else{const c=new Set(n);o.value=o.value.filter(_=>!c.has(_))}}function P(l,e){e?o.value.includes(l)||(o.value=[...o.value,l]):o.value=o.value.filter(n=>n!==l)}const U=[{title:"Dashboard",href:H().url},{title:"Roles",href:B().url},{title:v.role.name,href:W(v.role.id).url}];return(l,e)=>(f(),m(h,null,[s(i(T),{title:`Edit Role ${d.role.name}`},null,8,["title"]),s(X,{breadcrumbs:U},{default:a(()=>[t("div",Z,[t("div",ee,[t("div",se,[s(i(Y),{class:"h-6 w-6 text-primary"})]),t("div",null,[s(L,{title:`Edit ${d.role.name}`,description:"Update role details"},null,8,["title"])])]),t("div",te,[s(i(J),{class:"lg:col-span-2"},{default:a(()=>[s(i(V),{action:i(I).update(d.role.id)},{default:a(({errors:n,processing:c,recentlySuccessful:_})=>[e[14]||(e[14]=t("input",{type:"hidden",name:"_method",value:"PUT"},null,-1)),s(i(M),{class:"pb-4"},{default:a(()=>[...e[2]||(e[2]=[t("h3",{class:"text-sm font-medium text-muted-foreground"}," Role details ",-1)])]),_:1}),s(i(K),{class:"space-y-6"},{default:a(()=>[t("div",ie,[s(i(k),{for:"name"},{default:a(()=>[...e[3]||(e[3]=[r("Name ",-1),t("span",{class:"text-destructive"},"*",-1)])]),_:1}),s(i(R),{id:"name",name:"name","default-value":d.role.name,required:"",placeholder:"e.g. admin, editor",class:"transition-colors focus-visible:ring-2"},null,8,["default-value"]),s(b,{message:n.name},null,8,["message"])]),t("div",ae,[s(i(k),{for:"guard_name"},{default:a(()=>[...e[4]||(e[4]=[r("Guard name",-1)])]),_:1}),s(i(R),{id:"guard_name",name:"guard_name","default-value":d.role.guard_name,class:"font-mono transition-colors focus-visible:ring-2"},null,8,["default-value"]),s(b,{message:n.guard_name},null,8,["message"])]),s(i(Q)),t("div",le,[t("div",oe,[e[7]||(e[7]=t("h3",{class:"text-sm font-medium text-muted-foreground"}," Permissions (from policies) ",-1)),t("div",ne,[s(i(g),{type:"button",variant:"outline",size:"sm",onClick:e[0]||(e[0]=p=>$(!0))},{default:a(()=>[...e[5]||(e[5]=[r(" Check all ",-1)])]),_:1}),s(i(g),{type:"button",variant:"outline",size:"sm",onClick:e[1]||(e[1]=p=>$(!1))},{default:a(()=>[...e[6]||(e[6]=[r(" Uncheck all ",-1)])]),_:1})])]),e[10]||(e[10]=t("p",{class:"text-xs text-muted-foreground"}," Assign policy-based permissions to this role. Users with this role will be able to perform the selected actions. ",-1)),(f(!0),m(h,null,y(o.value,p=>(f(),m("input",{key:`hidden-${p}`,type:"hidden",name:"permission_ids[]",value:p},null,8,re))),128)),(f(!0),m(h,null,y(d.permissionsByResource,(p,x)=>(f(),m("div",{key:x,class:"space-y-2 rounded-lg border p-4"},[t("div",de,[t("h4",ue,C(x),1),t("div",me,[s(i(g),{type:"button",variant:"ghost",size:"sm",class:"h-7 text-xs",onClick:u=>w(x,!0)},{default:a(()=>[...e[8]||(e[8]=[r(" Check all ",-1)])]),_:1},8,["onClick"]),s(i(g),{type:"button",variant:"ghost",size:"sm",class:"h-7 text-xs",onClick:u=>w(x,!1)},{default:a(()=>[...e[9]||(e[9]=[r(" Uncheck all ",-1)])]),_:1},8,["onClick"])])]),t("div",fe,[(f(!0),m(h,null,y(p,u=>(f(),m("div",{key:u.id,class:"flex items-center space-x-2"},[t("input",{id:`perm-${u.id}`,type:"checkbox",checked:o.value.includes(u.id),class:"h-4 w-4 rounded border-input accent-primary",onChange:j=>P(u.id,j.target.checked)},null,40,ce),s(i(k),{for:`perm-${u.id}`,class:"text-sm font-normal cursor-pointer"},{default:a(()=>[r(C(u.ability_label),1)]),_:2},1032,["for"])]))),128))])]))),128)),Object.keys(d.permissionsByResource).length===0?(f(),m("p",pe," No policy permissions found. ")):q("",!0),s(b,{message:n.permission_ids},null,8,["message"])]),t("div",ge,[s(i(g),{disabled:c,type:"submit"},{default:a(()=>[...e[11]||(e[11]=[r(" Update Role ",-1)])]),_:1},8,["disabled"]),s(i(g),{variant:"outline","as-child":""},{default:a(()=>[s(i(A),{href:i(B)().url},{default:a(()=>[...e[12]||(e[12]=[r("Cancel",-1)])]),_:1},8,["href"])]),_:1}),s(D,{"enter-active-class":"transition ease-out duration-200","enter-from-class":"opacity-0 translate-y-1","leave-active-class":"transition ease-in duration-150","leave-to-class":"opacity-0"},{default:a(()=>[F(t("span",ve,[...e[13]||(e[13]=[t("span",{class:"h-1.5 w-1.5 rounded-full bg-green-500"},null,-1),r(" Role updated successfully ",-1)])],512),[[G,_]])]),_:2},1024)])]),_:2},1024)]),_:1},8,["action"])]),_:1})])])]),_:1})],64))}});export{Je as default};
